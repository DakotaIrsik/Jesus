#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run type checking
echo "ğŸ” Running type checks..."
pnpm type-check || exit 1

# Run linting
echo "ğŸ” Running ESLint..."
pnpm lint:fix || exit 1

# Run prettier
echo "ğŸ’… Running Prettier..."
pnpm format || exit 1

# Run Python formatting (if Python files changed)
if git diff --cached --name-only | grep -q '\.py$'; then
  echo "ğŸ Running Python formatters..."
  ruff check --fix . || exit 1
  black . || exit 1
fi

# Security checks
echo "ğŸ”’ Running security scans..."
pnpm security:npm || echo "âš ï¸  npm audit found vulnerabilities"

echo "âœ… Pre-commit checks passed!"
